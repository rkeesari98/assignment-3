<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixelShare - Login</title>
    <!-- Materialize CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Custom Styles -->
    <style>
        :root {
            --theme-primary: #5e35b1;
            --theme-primary-light: #9162e4;
            --theme-primary-dark: #280680;
            --theme-secondary: #26a69a;
            --theme-text-dark: #424242;
            --theme-text-light: #757575;
            --theme-background: #f5f5f5;
            --theme-card: #ffffff;
            --theme-border: #e0e0e0;
        }
        
        body {
            background-color: var(--theme-background);
            color: var(--theme-text-dark);
            font-family: 'Roboto', sans-serif;
            display: flex;
            min-height: 100vh;
            flex-direction: column;
            margin: 0;
        }
        
        /* Login container */
        .login-container {
            display: flex;
            flex-direction: row;
            min-height: 80vh;
            max-width: 935px;
            margin: 32px auto;
            justify-content: center;
            align-items: center;
        }
        
        /* Phone mockup (hidden on mobile) */
        .phone-container {
            display: none;
            position: relative;
            width: 380px;
            height: 581px;
            margin-right: 32px; 
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        @media (min-width: 876px) {
            .phone-container {
                display: block;
            }
        }
        
        /* Auth container */
        .auth-container {
            width: 100%;
            max-width: 350px;
            display: flex;
            flex-direction: column;
        }
        
        .auth-card {
            background-color: var(--theme-card);
            border: 1px solid var(--theme-border);
            border-radius: 3px;
            padding: 20px 40px;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .logo {
            font-size: 42px;
            font-weight: 700;
            color: var(--theme-primary);
            margin: 22px auto 12px;
            text-align: center;
        }
        
        .auth-form {
            width: 100%;
        }
        
        .input-field {
            margin-bottom: 6px;
        }
        
        .input-field input {
            background-color: var(--theme-background);
            border: 1px solid var(--theme-border);
            border-radius: 3px;
            padding: 10px 8px !important;
            height: 36px !important;
            box-sizing: border-box;
            font-size: 14px;
            width: 100%;
        }
        
        .input-field input:focus {
            border-color: #999 !important;
            box-shadow: none !important;
        }
        
        .auth-btn {
            background-color: var(--theme-primary);
            width: 100%;
            height: 36px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 14px;
            margin: 8px 0;
        }
        
        .auth-btn:disabled {
            opacity: 0.5;
        }
        
        .separator {
            display: flex;
            align-items: center;
            margin: 10px 0 18px;
        }
        
        .separator-line {
            flex-grow: 1;
            height: 1px;
            background-color: var(--theme-border);
        }
        
        .separator-text {
            padding: 0 18px;
            font-size: 13px;
            font-weight: 600;
            color: var(--theme-text-light);
        }
        
        .forgot-password {
            color: var(--theme-primary-dark);
            font-size: 12px;
            margin-top: 12px;
            text-align: center;
            display: block;
        }
        
        .switch-card {
            text-align: center;
            font-size: 14px;
            padding: 20px;
        }
        
        .switch-link {
            color: var(--theme-primary);
            font-weight: 600;
            cursor: pointer;
        }
        
        /* App download links */
        .app-links {
            margin-top: 20px;
            text-align: center;
        }
        
        .app-text {
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .app-images {
            display: flex;
            justify-content: center;
        }
        
        .app-image {
            height: 40px;
            margin: 0 4px;
        }
        
        /* Footer */
        footer {
            margin-top: auto;
            text-align: center;
            padding: 20px 0;
            color: var(--theme-text-light);
            font-size: 12px;
        }
        
        .footer-links {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 16px;
        }
        
        .footer-link {
            margin: 0 8px 8px;
            color: var(--theme-text-light);
            text-decoration: none;
        }
        
        .copyright {
            margin: 12px 0;
        }
        
        .language-selector {
            border: none;
            background: transparent;
            color: var(--theme-text-light);
            font-size: 12px;
        }

        /* Show only the login form initially */
        #signup-form {
            display: none;
        }

        /* Progress indicator */
        .progress {
            margin: 0;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            z-index: 9999;
            display: none;
        }
        
        .progress .indeterminate {
            background-color: var(--theme-primary);
        }
        
        /* Error message styling */
        .error-message {
            color: #ed4956;
            font-size: 14px;
            line-height: 18px;
            margin: 10px 0;
            text-align: center;
        }
        
        /* Hide elements with hidden class */
        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <!-- Progress indicator -->
    <div class="progress" id="auth-progress">
        <div class="indeterminate"></div>
    </div>
    
    <!-- Login Box (Not visible to the user, but needed for firebase-login.js) -->
    <div id="login-box" class="hidden">
        <input type="email" id="email">
        <input type="password" id="password">
        <button id="login">Login</button>
        <button id="sign-up">Sign Up</button>
    </div>
    
    <!-- Sign Out Button (Hidden, needed for firebase-login.js) -->
    <button id="sign-out" class="hidden">Sign Out</button>

    <main class="login-container">
        <!-- Left side phone mockup (hidden on mobile) -->
        <div class="phone-container">
            <!-- Phone mockup with screenshot -->
            
        </div>
        
        <!-- Right side authentication forms -->
        <div class="auth-container">
            <!-- Main authentication card -->
            <div class="auth-card">
                <h1 class="logo">PixelShare</h1>
                
                <!-- Login Form (shown by default) -->
                <form class="auth-form" id="login-form">
                    <div class="error-message" id="login-error" style="display: none;"></div>
                    
                    <div class="input-field">
                        <input type="email" id="login-email" placeholder="Email" required>
                    </div>
                    
                    <div class="input-field">
                        <input type="password" id="login-password" placeholder="Password" required>
                    </div>
                    
                    <button type="button" class="waves-effect waves-light btn auth-btn" id="login-btn" disabled>Log In</button>
                    
                    <div class="separator">
                        <div class="separator-line"></div>
                        <div class="separator-text">OR</div>
                        <div class="separator-line"></div>
                    </div>
                    
                    <a href="#" class="forgot-password">Forgot password?</a>
                </form>
                
                <!-- Signup Form (hidden by default) -->
                <form class="auth-form" id="signup-form">
                    <div class="error-message" id="signup-error" style="display: none;"></div>
                    
                    <div class="input-field">
                        <input type="email" id="signup-email" placeholder="Email" required>
                    </div>
                    
                    
                    <div class="input-field">
                        <input type="password" id="signup-password" placeholder="Password" required>
                    </div>
                    
                    <button type="button" class="waves-effect waves-light btn auth-btn" id="signup-btn" disabled>Sign Up</button>
                    
                    <div class="separator">
                        <div class="separator-line"></div>
                        <div class="separator-text">OR</div>
                        <div class="separator-line"></div>
                    </div>
                    
                    <p style="text-align: center; font-size: 12px; color: var(--theme-text-light); margin: 10px 0;">
                        By signing up, you agree to our <br>
                        <a href="#" style="color: var(--theme-text-light);">Terms</a>, <a href="#" style="color: var(--theme-text-light);">Privacy Policy</a> and <a href="#" style="color: var(--theme-text-light);">Cookies Policy</a>
                    </p>
                </form>
            </div>
            
            <!-- Switch between login/signup -->
            <div class="auth-card switch-card">
                <p id="login-switch-text">
                    Don't have an account? <span class="switch-link" id="show-signup">Sign up</span>
                </p>
                <p id="signup-switch-text" style="display: none;">
                    Have an account? <span class="switch-link" id="show-login">Log in</span>
                </p>
            </div>
            
            <!-- App download links -->
            <div class="app-links">
                <p class="app-text">Get the app.</p>
                <div class="app-images">
                    <!-- <img src="/static/google-play.png" alt="Get it on Google Play" class="app-image" onerror="this.src='/static/placeholder.png'">
                    <img src="/static/app-store.png" alt="Download on App Store" class="app-image" onerror="this.src='/static/placeholder.png'"> -->
                </div>
            </div>
        </div>
    </main>
    
    <footer>
        <div class="footer-links">
            <a href="#" class="footer-link">About</a>
            <a href="#" class="footer-link">Blog</a>
            <a href="#" class="footer-link">Jobs</a>
            <a href="#" class="footer-link">Help</a>
            <a href="#" class="footer-link">API</a>
            <a href="#" class="footer-link">Privacy</a>
            <a href="#" class="footer-link">Terms</a>
            <a href="#" class="footer-link">Top Accounts</a>
            <a href="#" class="footer-link">Hashtags</a>
            <a href="#" class="footer-link">Locations</a>
        </div>
        
        <div class="language-selector-container">
            <select class="language-selector">
                <option value="en">English</option>
                <option value="es">Español</option>
                <option value="fr">Français</option>
                <option value="de">Deutsch</option>
                <option value="it">Italiano</option>
                <option value="pt">Português</option>
            </select>
        </div>
        
        <div class="copyright">
            © 2025 PixelShare
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    
    <!-- Custom Auth UI Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM loaded - Initializing Auth Page");
            
            // Initialize UI elements
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            const loginBtn = document.getElementById('login-btn');
            const signupBtn = document.getElementById('signup-btn');
            const showSignupLink = document.getElementById('show-signup');
            const showLoginLink = document.getElementById('show-login');
            const loginSwitchText = document.getElementById('login-switch-text');
            const signupSwitchText = document.getElementById('signup-switch-text');
            const loginError = document.getElementById('login-error');
            const signupError = document.getElementById('signup-error');
            const progressIndicator = document.getElementById('auth-progress');
            
            // Original Firebase auth form elements (hidden)
            const firebaseEmail = document.getElementById('email');
            const firebasePassword = document.getElementById('password');
            const firebaseLoginBtn = document.getElementById('login');
            const firebaseSignupBtn = document.getElementById('sign-up');
            
            // Input fields for UI forms
            const loginEmail = document.getElementById('login-email');
            const loginPassword = document.getElementById('login-password');
            const signupEmail = document.getElementById('signup-email');
            
            const signupPassword = document.getElementById('signup-password');
            
            // Enable/disable login button based on input
            function validateLoginForm() {
                const email = loginEmail.value.trim();
                const password = loginPassword.value.trim();
                loginBtn.disabled = !(email && password);
            }
            
            // Enable/disable signup button based on input
            function validateSignupForm() {
                const email = signupEmail.value.trim();
                const password = signupPassword.value.trim();
                signupBtn.disabled = !(email && password);
            }
            
            // Input validation
            loginEmail.addEventListener('input', validateLoginForm);
            loginPassword.addEventListener('input', validateLoginForm);
            signupEmail.addEventListener('input', validateSignupForm);
            signupPassword.addEventListener('input', validateSignupForm);
            
            // Switch between login and signup forms
            showSignupLink.addEventListener('click', (e) => {
                e.preventDefault();
                loginForm.style.display = 'none';
                signupForm.style.display = 'block';
                loginSwitchText.style.display = 'none';
                signupSwitchText.style.display = 'block';
                loginError.style.display = 'none';
                signupError.style.display = 'none';
            });
            
            showLoginLink.addEventListener('click', (e) => {
                e.preventDefault();
                signupForm.style.display = 'none';
                loginForm.style.display = 'block';
                signupSwitchText.style.display = 'none';
                loginSwitchText.style.display = 'block';
                loginError.style.display = 'none';
                signupError.style.display = 'none';
            });
            
            // Login button click handler
            loginBtn.addEventListener('click', () => {
                const email = loginEmail.value.trim();
                const password = loginPassword.value.trim();
                
                if (!email || !password) {
                    loginError.textContent = "Email and password are required";
                    loginError.style.display = 'block';
                    return;
                }
                
                // Show loading indicator
                progressIndicator.style.display = 'block';
                loginBtn.disabled = true;
                
                // Transfer values to the hidden form and trigger the click
                firebaseEmail.value = email;
                firebasePassword.value = password;
                firebaseLoginBtn.click();
                
                // Add error handling for when firebase auth fails
                // This event listener will check for error messages added by firebase-login.js
                setTimeout(() => {
                    if (document.cookie.indexOf("token=") === -1) {
                        // If no token set after timeout, assume login failed
                        loginError.textContent = "Login failed. Please check your email and password.";
                        loginError.style.display = 'block';
                        progressIndicator.style.display = 'none';
                        loginBtn.disabled = false;
                    }
                }, 3000);
            });
            
            // Signup button click handler
            signupBtn.addEventListener('click', () => {
                const email = signupEmail.value.trim();
                const password = signupPassword.value.trim();
                
                if (!email || !password) {
                    signupError.textContent = "All fields are required";
                    signupError.style.display = 'block';
                    return;
                }
                
                if (password.length < 6) {
                    signupError.textContent = "Password must be at least 6 characters";
                    signupError.style.display = 'block';
                    return;
                }
                
                // Show loading indicator
                progressIndicator.style.display = 'block';
                signupBtn.disabled = true;
                
                // Save additional user data to localStorage to be used after signup
                
                // Transfer values to the hidden form and trigger the click
                firebaseEmail.value = email;
                firebasePassword.value = password;
                firebaseSignupBtn.click();
                
                // Add error handling for when firebase auth fails
                setTimeout(() => {
                    if (document.cookie.indexOf("token=") === -1) {
                        // If no token set after timeout, assume signup failed
                        signupError.textContent = "Sign up failed. This email may already be in use.";
                        signupError.style.display = 'block';
                        progressIndicator.style.display = 'none';
                        signupBtn.disabled = false;
                    }
                }, 3000);
            });
            
            // Enter key on login form
            loginForm.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    if (!loginBtn.disabled) {
                        loginBtn.click();
                    }
                }
            });
            
            // Enter key on signup form
            signupForm.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    if (!signupBtn.disabled) {
                        signupBtn.click();
                    }
                }
            });
            
            // Check if the user is already logged in
            if (document.cookie.indexOf("token=") !== -1) {
                window.location.href = '/';
            }
        });
    </script>
    
    <script type="module" src="/static/firebase-login.js"></script>
</body>
</html>